@inject HttpClient Http

<DxPopup HeaderText="Add Favorite" @bind-Visible="@IsVisible">
    <Content>
        <EditForm Model="@Favorite" OnValidSubmit="@OnSave">

            <DataAnnotationsValidator />
            <ValidationSummary />

            <div class="form-group">
                <label for="lastName">Favorite Name: </label>
                <InputText id="lastName" class="form-control" @bind-Value="@Favorite.Name" placeholder="Enter the favorite's name"></InputText>
                <ValidationMessage For="@(() => Favorite.Name)" />
            </div>

            <div class="form-group">
                <label for="firstName">Favorite URI: </label>
                <InputText id="firstName" class="form-control" @bind-Value="@Favorite.Uri" placeholder="https://"></InputText>
                <ValidationMessage For="@(() => Favorite.Uri)" />
            </div>

            <button class="btn btn-success" type="submit">Save</button>
            <button class="btn btn-light" @onclick="@(() => IsVisible = false)">Cancel</button>
        </EditForm>
    </Content>
</DxPopup>

@code{
    public FavoriteDTO Favorite { get; set; } = new FavoriteDTO();

    [Parameter]
    public EventCallback<Guid> OnNewFavoriteSaved { get; set; }

    public bool IsVisible { get; set; }

    protected async Task OnSave()
    {
        IsVisible = false;

        // Temporarily hard-coding meta data
        Favorite.OwnerId = Guid.Parse("66A5DB8A-47F7-48A5-98F8-80B34452BF34");
        Favorite.FolderId = Guid.Parse("25641521-06E9-4E89-8425-EF22E365C5A4");

        Console.WriteLine("[Adding New Favorite]");
        await Http.PostAsJsonAsync<FavoriteDTO>($"https://localhost:44373/api/favorite", Favorite);
        await OnNewFavoriteSaved.InvokeAsync(Favorite.Id);
    }
}
