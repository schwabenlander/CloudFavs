<tr>
    <td>@Favorite.Name</td>
    <td><a href="@Favorite.Uri" target="_blank">@Favorite.Uri</a></td>
    <td>
        <DxButton RenderStyle="@ButtonRenderStyle.Info" RenderStyleMode="@ButtonRenderStyleMode.Contained" 
                  Click="@OnEditClicked" Text="Edit" />
        <DxButton RenderStyle="@ButtonRenderStyle.Danger" RenderStyleMode="@ButtonRenderStyleMode.Contained"
                  Click="@OnDeleteClicked" Text="Delete" />
    </td>
</tr>

<DxPopup HeaderText="Delete Confirmation" @bind-Visible="@DeleteConfirmationVisible">
    <Content>
        <p>
            Are you sure you want to delete this favorite?
        </p>
        <p>
            <button class="btn btn-danger" @onclick="OnDeleteConfirmed">Delete</button>
            <button class="btn btn-light" @onclick="@(() => DeleteConfirmationVisible = false)">Cancel</button>
        </p>
    </Content>
</DxPopup>

<EditFavoritePopup @ref="EditFavoritePopup" Favorite="Favorite" OnEditSaved="OnEditSaved"></EditFavoritePopup>

@code{
    [Parameter]
    public FavoriteDTO Favorite { get; set; }

    [Parameter]
    public EventCallback<Guid> OnFavoriteDeleted { get; set; }

    private EditFavoritePopup EditFavoritePopup { get; set; }

    public bool DeleteConfirmationVisible { get; set; }

    protected override Task OnInitializedAsync()
    {
        return base.OnInitializedAsync();
    }

    protected void OnDeleteClicked(MouseEventArgs args)
    {
        DeleteConfirmationVisible = true;
    }

    protected void OnEditClicked(MouseEventArgs args)
    {
        EditFavoritePopup.IsVisible = true;
    }

    protected async Task OnDeleteConfirmed()
    {
        DeleteConfirmationVisible = false;
        await OnFavoriteDeleted.InvokeAsync(Favorite.Id);
    }

    protected void OnEditSaved()
    {
        InvokeAsync(StateHasChanged);
    }
}